"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _xeUtils=_interopRequireDefault(require("xe-utils/methods/xe-utils")),_tools=require("../../tools");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperty(e,t,l){return t in e?Object.defineProperty(e,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[t]=l,e}var cellType="footer";function mergeFooterMethod(e,t,l){for(var o=0;o<e.length;o++){var r=e[o],n=r.row,i=r.col,a=r.rowspan,c=r.colspan;if(-1<i&&-1<n&&a&&c){if(n===t&&i===l)return{rowspan:a,colspan:c};if(n<=t&&t<n+a&&i<=l&&l<i+c)return{rowspan:0,colspan:0}}}}var _default={name:"VxeTableFooter",props:{footerData:Array,tableColumn:Array,visibleColumn:Array,fixedColumn:Array,size:String,fixedType:String},mounted:function(){var e=this.$parent,t=this.$el,l=this.$refs,o=this.fixedType,r=e.elemStore,n="".concat(o||"main","-footer-");r["".concat(n,"wrapper")]=t,r["".concat(n,"table")]=l.table,r["".concat(n,"colgroup")]=l.colgroup,r["".concat(n,"list")]=l.tfoot,r["".concat(n,"xSpace")]=l.xSpace},render:function(E){var e=this._e,O=this.$parent,q=this.fixedType,t=this.fixedColumn,A=this.tableColumn,D=this.footerData,M=O.$listeners,l=O.tId,o=O.footerRowClassName,X=O.footerCellClassName,r=O.footerRowStyle,j=O.footerCellStyle,N=O.footerAlign,R=O.mergeFooterList,z=O.footerSpanMethod,B=O.align,H=O.scrollXLoad,K=O.columnKey,V=O.showFooterOverflow,W=O.currentColumn,Y=O.overflowX,n=O.scrollbarWidth,G=O.tooltipOpts;return R.length&&z||(q&&V?A=t:H&&q&&(A=t)),E("div",{class:["vxe-table--footer-wrapper",q?"fixed-".concat(q,"--wrapper"):"body--wrapper"],attrs:{"data-tid":l},on:{scroll:this.scrollEvent}},[q?e():E("div",{class:"vxe-body--x-space",ref:"xSpace"}),E("table",{class:"vxe-table--footer",attrs:{"data-tid":l,cellspacing:0,cellpadding:0,border:0},ref:"table"},[E("colgroup",{ref:"colgroup"},A.map(function(e,t){return E("col",{attrs:{name:e.id},key:t})}).concat(n?[E("col",{attrs:{name:"col_gutter"}})]:[])),E("tfoot",{ref:"tfoot"},D.map(function(P,U){var k=U;return E("tr",{class:["vxe-footer--row",o?_xeUtils.default.isFunction(o)?o({$table:O,_rowIndex:U,$rowIndex:k,fixed:q,type:cellType}):o:""],style:r?_xeUtils.default.isFunction(r)?r({$table:O,_rowIndex:U,$rowIndex:k,fixed:q,type:cellType}):r:null},A.map(function(t,e){var l,o=t.showFooterOverflow,r=t.footerAlign,n=t.align,i=t.footerClassName,a=G.enabled,c=t.children&&t.children.length,s=q?t.fixed!==q&&!c:t.fixed&&Y,d=_xeUtils.default.isUndefined(o)||_xeUtils.default.isNull(o)?V:o,f=r||n||N||B,u="ellipsis"===d,p="title"===d,x=!0===d||"tooltip"===d,v=p||x||u,m={"data-colid":t.id},y={},g=O.getColumnIndex(t),b=O._getColumnIndex(t),_={$table:O,_rowIndex:U,$rowIndex:k,column:t,columnIndex:g,$columnIndex:e,_columnIndex:b,itemIndex:b,items:P,fixed:q,type:cellType,data:D};if(H&&!v&&(u=v=!0),(p||x||a)&&(y.mouseenter=function(e){p?_tools.DomTools.updateCellTitle(e.currentTarget,t):(x||a)&&O.triggerFooterTooltipEvent(e,_)}),(x||a)&&(y.mouseleave=function(e){(x||a)&&O.handleTargetLeaveEvent(e)}),M["footer-cell-click"]&&(y.click=function(e){O.emitEvent("footer-cell-click",Object.assign({cell:e.currentTarget},_),e)}),M["footer-cell-dblclick"]&&(y.dblclick=function(e){O.emitEvent("footer-cell-dblclick",Object.assign({cell:e.currentTarget},_),e)}),R.length){var h=mergeFooterMethod(R,U,b);if(h){var w=h.rowspan,T=h.colspan;if(!w||!T)return null;1<w&&(m.rowspan=w),1<T&&(m.colspan=T)}}else if(z){var $=z(_)||{},C=$.rowspan,I=void 0===C?1:C,S=$.colspan,F=void 0===S?1:S;if(!I||!F)return null;1<I&&(m.rowspan=I),1<F&&(m.colspan=F)}var L="seq"===t.type||"index"===t.type?"seq":t.type;return E("td",{class:["vxe-footer--column",t.id,(l={},_defineProperty(l,"col--".concat(f),f),_defineProperty(l,"col--".concat(L),L),_defineProperty(l,"col--last",e===A.length-1),_defineProperty(l,"fixed--hidden",s),_defineProperty(l,"col--ellipsis",v),_defineProperty(l,"col--current",W===t),l),_tools.UtilTools.getClass(i,_),_tools.UtilTools.getClass(X,_)],attrs:m,style:j?_xeUtils.default.isFunction(j)?j(_):j:null,on:y,key:K?t.id:e},[E("div",{class:["vxe-cell",{"c--title":p,"c--tooltip":x,"c--ellipsis":u}]},t.renderFooter(E,_))])}).concat(n?[E("td",{class:"col--gutter"})]:[]))}))])])},methods:{scrollEvent:function(e){var t=this.$parent,l=this.fixedType,o=t.$refs,r=t.scrollXLoad,n=t.triggerScrollXEvent,i=t.lastScrollLeft,a=o.tableHeader,c=o.tableBody,s=o.tableFooter,d=o.validTip,f=a?a.$el:null,u=s?s.$el:null,p=c.$el,x=u.scrollLeft,v=x!==i;t.lastScrollLeft=x,t.lastScrollTime=Date.now(),f&&(f.scrollLeft=x),p&&(p.scrollLeft=x),r&&v&&n(e),v&&d&&d.visible&&d.updatePlacement(),t.emitEvent("scroll",{type:cellType,fixed:l,scrollTop:p.scrollTop,scrollLeft:x,isX:v,isY:!1},e)}}};exports.default=_default;